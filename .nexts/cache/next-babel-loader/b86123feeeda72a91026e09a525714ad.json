{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/cerassus/Websites/gamergeek-nextjs/components/main/challenge/Table.js\";\nimport Table from \"../../styled-components/Table\";\nimport Typography from \"../../styled-components/Typography\";\nimport { useState, useEffect, Fragment } from \"react\";\nimport { pickRandomGame } from \"../../../global/fetch\";\nimport { game_database } from \"../../../global/const\";\nimport moment from 'moment';\nimport * as SC from \"../../styled-components/Popup\";\nconst game_difficulty = [\"easy\", \"medium\", \"hard\"];\nexport default function TableComponent({\n  random_game,\n  startGame,\n  startLoading,\n  endGame,\n  user_score,\n  clearUserScore,\n  showRandomGame,\n  pushNewAnswer,\n  showHint,\n  clearHint,\n  game_status\n}) {\n  const {\n    0: answerTimeStart,\n    1: setAnswerTimeStart\n  } = useState(false);\n  const {\n    0: hintCounter,\n    1: setHintCounter\n  } = useState(0);\n  const {\n    0: hints,\n    1: setHints\n  } = useState(false);\n  const {\n    0: difficulty,\n    1: setDifficulty\n  } = useState(false);\n  const {\n    0: usernamePanel,\n    1: showUsernamePanel\n  } = useState(true);\n  const {\n    0: warning,\n    1: setWarning\n  } = useState(false);\n  const {\n    0: popup,\n    1: switchPopup\n  } = useState(false);\n  const {\n    0: summary,\n    1: showSummary\n  } = useState(false);\n  const {\n    0: username,\n    1: setUsername\n  } = useState(false);\n\n  const startNewGame = () => {\n    switchPopup(true);\n  };\n\n  const loadNewQuestion = async () => {\n    startLoading();\n    clearHint();\n    setHintCounter(0);\n    showRandomGame(await pickRandomGame(game_database));\n  };\n\n  const quitGame = () => {\n    clearHint();\n    setHintCounter(0);\n    setHints(false);\n    showUsernamePanel(true);\n    setDifficulty(false);\n    setUsername(false);\n    setAnswerTimeStart(false);\n    switchPopup(false);\n    user_score.length > 0 && showSummary(true);\n  };\n\n  const getHint = () => {\n    showHint(...hints.splice(Math.floor(Math.random() * hints.length), 1));\n    setHintCounter(hintCounter => hintCounter + 1);\n  };\n\n  const handleTyping = e => {\n    0 < e.target.value.length && e.target.value.length < 3 ? setWarning(true) : setWarning(false); // check if username doesn't match one of usernames in MongoDatabase\n\n    setUsername(e.target.value);\n  };\n\n  const validateUserName = () => {\n    warning || !username ? alert('Wrong username! Try different one!') : showUsernamePanel(false);\n  };\n\n  const close_summary = () => {\n    showSummary(false);\n    clearUserScore();\n  };\n\n  const checkAnswer = async answer => {\n    const answerTimeEnd = moment();\n    const user_answer = answer === random_game.name ? {\n      title: random_game.name,\n      time: answerTimeEnd.diff(answerTimeStart),\n      score: Number((1000 / answerTimeEnd.diff(answerTimeStart) * 10000 * ((10 - hintCounter) / 10)).toFixed()),\n      correct: true,\n      hints_used: hintCounter\n    } : {\n      title: random_game.name,\n      time: answerTimeEnd.diff(answerTimeStart),\n      score: 0,\n      correct: false,\n      skip: answer === \"player_skipped_game\" ? true : false,\n      hints_used: hintCounter\n    };\n    pushNewAnswer(user_answer);\n    loadNewQuestion();\n  };\n\n  useEffect(() => {\n    !game_status.isLoading && setAnswerTimeStart(moment());\n    !game_status.isStarted && quitGame();\n  }, [game_status]);\n  useEffect(() => {\n    random_game && setHints(random_game.hints);\n  }, [random_game]);\n  useEffect(() => {\n    if (difficulty) {\n      switchPopup(false);\n      startGame(difficulty);\n      loadNewQuestion();\n    }\n  }, [difficulty]);\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Table, {\n      top: true,\n      children: !game_status.isStarted ? /*#__PURE__*/_jsxDEV(Typography, {\n        link: true,\n        onClick: () => startNewGame(),\n        children: \"start a new challenge\"\n      }, \"key0015\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }, this) : game_status.isLoading ? /*#__PURE__*/_jsxDEV(Typography, {\n        link: true,\n        children: \"loading\"\n      }, 'key0016', false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 12\n      }, this) : /*#__PURE__*/_jsxDEV(Fragment, {\n        children: [hintCounter < 3 && /*#__PURE__*/_jsxDEV(Typography, {\n          link: true,\n          onClick: () => getHint(),\n          children: \"get a hint\"\n        }, \"key0011\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 35\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          link: true,\n          onClick: () => checkAnswer(\"player_skipped_game\"),\n          children: \"skip\"\n        }, \"key0012\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          link: true,\n          onClick: () => endGame(),\n          children: \"quit\"\n        }, \"key0013\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Table, {\n      bottom: true,\n      children: game_status.isStarted && !game_status.isLoading && random_game.answers ? random_game.answers.map((answer, i) => /*#__PURE__*/_jsxDEV(Typography, {\n        answer: true,\n        onClick: answer => checkAnswer(answer.target.innerText),\n        children: answer\n      }, \"key0021\" + i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)) : ``\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SC.Popup, {\n      title: \"Hello gamergeek!\",\n      switch_popup: popup,\n      popupIsClosed: () => quitGame(),\n      children: usernamePanel ? /*#__PURE__*/_jsxDEV(Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(SC.WelcomeText, {\n          children: \"Let\\u2019s see how good you are! Starting from your name...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(SC.TextInput, {\n          type: \"text\",\n          onChange: e => handleTyping(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(SC.TextInputHint, {\n          visible: warning,\n          children: \"Wrong nickname\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(SC.PlayButton, {\n          onClick: () => validateUserName(),\n          children: \"Let's Play!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(SC.WelcomeText, {\n          center: true,\n          children: \"Set game difficulty...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 15\n        }, this), game_difficulty.map((diff_lvl, i) => /*#__PURE__*/_jsxDEV(SC.PlayButton, {\n          onClick: () => setDifficulty(diff_lvl),\n          children: diff_lvl\n        }, \"key0011\" + i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 17\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SC.Popup, {\n      title: \"Summary\",\n      switch_popup: summary,\n      popupIsClosed: () => close_summary(),\n      children: user_score.length > 0 && summary && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          width: \"85%\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: \"50%\",\n            padding: \"1rem\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(SC.WelcomeText, {\n            children: \"The Game\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n            children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"Correct answers:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: user_score.filter(x => x.correct).length\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"Wrong answers:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: user_score.filter(x => !x.correct).length\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"Skipped answers:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: user_score.filter(x => x.skip).length\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"Hints used:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 157,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: user_score.map(x => x = x.hints_used).reduce((acc, y) => acc + y)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"Quickest response:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: user_score.sort((a, b) => a - b)[0]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"Slowest response:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: user_score.filter(x => x.correct).length\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 166,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"Average time response:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: user_score.filter(x => x.correct).length\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: \"50%\",\n            padding: \"1rem\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(SC.WelcomeText, {\n            children: \"Score:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: \"3rem\"\n            },\n            children: user_score.map(score => score = score.score).reduce((acc, score) => acc + score)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(SC.PlayButton, {\n            onClick: () => close_summary(),\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}","map":{"version":3,"sources":["/home/cerassus/Websites/gamergeek-nextjs/components/main/challenge/Table.js"],"names":["Table","Typography","useState","useEffect","Fragment","pickRandomGame","game_database","moment","SC","game_difficulty","TableComponent","random_game","startGame","startLoading","endGame","user_score","clearUserScore","showRandomGame","pushNewAnswer","showHint","clearHint","game_status","answerTimeStart","setAnswerTimeStart","hintCounter","setHintCounter","hints","setHints","difficulty","setDifficulty","usernamePanel","showUsernamePanel","warning","setWarning","popup","switchPopup","summary","showSummary","username","setUsername","startNewGame","loadNewQuestion","quitGame","length","getHint","splice","Math","floor","random","handleTyping","e","target","value","validateUserName","alert","close_summary","checkAnswer","answer","answerTimeEnd","user_answer","name","title","time","diff","score","Number","toFixed","correct","hints_used","skip","isLoading","isStarted","answers","map","i","innerText","diff_lvl","display","width","padding","filter","x","reduce","acc","y","sort","a","b","marginBottom"],"mappings":"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","sourcesContent":["import Table from \"../../styled-components/Table\";\nimport Typography from \"../../styled-components/Typography\";\nimport { useState, useEffect, Fragment } from \"react\";\nimport { pickRandomGame } from \"../../../global/fetch\";\nimport { game_database } from \"../../../global/const\";\nimport moment from 'moment'\nimport * as SC from \"../../styled-components/Popup\"\n\nconst game_difficulty = [\"easy\", \"medium\", \"hard\"];\n\nexport default function TableComponent({\n    random_game, startGame, startLoading, endGame, user_score, clearUserScore,\n    showRandomGame, pushNewAnswer, showHint, clearHint, game_status,}) {\n  const [answerTimeStart, setAnswerTimeStart] = useState(false)\n  const [hintCounter, setHintCounter] = useState(0)\n  const [hints, setHints] = useState(false)\n  const [difficulty, setDifficulty] = useState(false)\n  const [usernamePanel, showUsernamePanel] = useState(true)\n  const [warning, setWarning] = useState(false)\n  const [popup, switchPopup] = useState(false)\n  const [summary, showSummary] = useState(false)\n  const [username, setUsername] = useState(false)\n\n  const startNewGame = () => {\n    switchPopup(true)\n  }\n  const loadNewQuestion = async () => {\n    startLoading()\n    clearHint()\n    setHintCounter(0)\n    showRandomGame(await pickRandomGame(game_database))\n  } \n  const quitGame = () => {\n    clearHint()\n    setHintCounter(0)\n    setHints(false)\n    showUsernamePanel(true)\n    setDifficulty(false)\n    setUsername(false)\n    setAnswerTimeStart(false)\n    switchPopup(false)\n    user_score.length > 0 && showSummary(true)\n  }\n  const getHint = () => {\n    showHint(...hints.splice(Math.floor(Math.random() * hints.length), 1))\n    setHintCounter(hintCounter => hintCounter + 1)\n  }\n  const handleTyping = (e) => {\n    (0 < e.target.value.length && e.target.value.length < 3) \n      ? setWarning(true)\n      : setWarning(false);   // check if username doesn't match one of usernames in MongoDatabase\n    setUsername(e.target.value)\n  }\n  const validateUserName = () => {\n    (warning || !username) ? alert('Wrong username! Try different one!') : showUsernamePanel(false)\n  }\n  const close_summary = () => {\n    showSummary(false)\n    clearUserScore()\n  }\n  const checkAnswer = async (answer) => {\n    const answerTimeEnd = moment()\n    const user_answer = answer === random_game.name\n        ? {\n            title: random_game.name,\n            time: answerTimeEnd.diff(answerTimeStart),\n            score: Number((1000/answerTimeEnd.diff(answerTimeStart)*10000*((10-hintCounter)/10)).toFixed()),\n            correct: true,\n            hints_used: hintCounter,\n          }\n        : {\n            title: random_game.name,\n            time: answerTimeEnd.diff(answerTimeStart),\n            score: 0,\n            correct: false,\n            skip: answer === \"player_skipped_game\" ? true: false,\n            hints_used: hintCounter,\n          };\n    pushNewAnswer(user_answer)\n    loadNewQuestion()\n  }\n\n  useEffect(() => {\n    !game_status.isLoading && setAnswerTimeStart(moment())\n    !game_status.isStarted && quitGame()\n  }, [game_status])\n  useEffect(() => {\n    random_game && setHints(random_game.hints) \n  }, [random_game])\n  useEffect(() => {\n    if(difficulty) {\n      switchPopup(false)\n      startGame(difficulty)\n      loadNewQuestion()\n    }\n  },[difficulty])\n\n  return (\n    <Fragment>\n      <Table top>    \n        {!game_status.isStarted ?\n          <Typography key={\"key0015\"} link onClick={() => startNewGame()}>start a new challenge</Typography>\n          : game_status.isLoading ?\n           <Typography key={'key0016'} link>loading</Typography>\n           : (\n            <Fragment>\n              {hintCounter < 3 && <Typography key={\"key0011\"} link onClick={() => getHint()}>get a hint</Typography>}\n              <Typography key={\"key0012\"} link onClick={() => checkAnswer(\"player_skipped_game\")}>skip</Typography>\n              <Typography key={\"key0013\"} link onClick={() => endGame()}>quit</Typography>\n            </Fragment>\n          )}\n      </Table>\n      <Table bottom>\n        {(game_status.isStarted && !game_status.isLoading && random_game.answers) ?\n        random_game.answers.map((answer, i) => (\n        <Typography key={\"key0021\"+i} answer onClick={(answer) => checkAnswer(answer.target.innerText)}>{answer}</Typography>))\n        : ``}\n      </Table>\n      <SC.Popup title=\"Hello gamergeek!\" switch_popup={popup} popupIsClosed={() => quitGame()}>\n          {usernamePanel ? (\n            <Fragment>\n              <SC.WelcomeText>Letâ€™s see how good you are! Starting from your name...</SC.WelcomeText>\n              <SC.TextInput type=\"text\" onChange={(e) => handleTyping(e)} />\n              <SC.TextInputHint visible={warning}>Wrong nickname</SC.TextInputHint>\n              <SC.PlayButton onClick={() => validateUserName()}>Let's Play!</SC.PlayButton>\n            </Fragment>\n          ) : (\n            <Fragment>\n              <SC.WelcomeText center>Set game difficulty...</SC.WelcomeText>\n              {game_difficulty.map((diff_lvl, i) => (\n                <SC.PlayButton key={\"key0011\" + i} onClick={() => setDifficulty(diff_lvl)}>\n                  {diff_lvl}\n                </SC.PlayButton>\n              ))}\n            </Fragment>\n          )}\n      </SC.Popup>\n      <SC.Popup title=\"Summary\" switch_popup={summary} popupIsClosed={() => close_summary()}>\n        {(user_score.length > 0 && summary) && (\n          <div style={{display: \"flex\", width: \"85%\"}}>\n            <div style={{width: \"50%\", padding: \"1rem\"}}>\n              <SC.WelcomeText>The Game</SC.WelcomeText>\n              <table>\n                <tr>\n                  <td>Correct answers:</td>\n                  <td>{user_score.filter(x => x.correct).length}</td>\n                </tr>\n                <tr>\n                  <td>Wrong answers:</td>\n                  <td>{user_score.filter(x => !x.correct).length}</td>\n                </tr>\n                <tr>\n                  <td>Skipped answers:</td>\n                  <td>{user_score.filter(x => x.skip).length}</td>\n                </tr>\n                <tr>\n                  <td>Hints used:</td>\n                  <td>{user_score.map(x => x = x.hints_used).reduce((acc,y) => acc + y)}</td>\n                </tr>\n                <tr>\n                  <td>Quickest response:</td>\n                  <td>{user_score.sort((a,b) => a - b)[0]}</td>\n                </tr>                \n                <tr>\n                  <td>Slowest response:</td>\n                  <td>{user_score.filter(x => x.correct).length}</td>\n                </tr>                \n                <tr>\n                  <td>Average time response:</td>\n                  <td>{user_score.filter(x => x.correct).length}</td>\n                </tr>\n              </table>\n            </div>\n            <div style={{width: \"50%\", padding: \"1rem\"}}>\n              <SC.WelcomeText>Score:</SC.WelcomeText>\n              <div style={{marginBottom: \"3rem\"}}>{user_score.map(score => score = score.score).reduce((acc,score) => acc + score)}</div>\n              <SC.PlayButton onClick={() => close_summary()}>Close</SC.PlayButton>\n            </div>\n          </div>\n        )}\n      </SC.Popup>\n    </Fragment>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}